---
name: agent-trace
description: Agent Traceä»•æ§˜ã«åŸºã¥ãAIç”Ÿæˆã‚³ãƒ¼ãƒ‰ã®å¸°å±è¿½è·¡ãƒ»çµ±è¨ˆãƒ»ç®¡ç†ã‚¹ã‚­ãƒ«ã€‚ç·¨é›†å±¥æ­´ã®ç¢ºèªã€AI/äººé–“ã®è²¢çŒ®ç‡åˆ†æã€ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã€‚
---

# Agent Trace - AIç”Ÿæˆã‚³ãƒ¼ãƒ‰å¸°å±è¿½è·¡ã‚¹ã‚­ãƒ«

Agent Traceä»•æ§˜ï¼ˆv0.1.0ï¼‰ã«åŸºã¥ãAIç”Ÿæˆã‚³ãƒ¼ãƒ‰ã®å¸°å±è¿½è·¡ãƒ»ç®¡ç†ã‚¹ã‚­ãƒ«ã€‚
è‡ªå‹•è¨˜éŒ²ã•ã‚ŒãŸãƒˆãƒ¬ãƒ¼ã‚¹ã®ç¢ºèªã€çµ±è¨ˆåˆ†æã€ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚’æ”¯æ´ã€‚

## ãƒˆãƒªã‚¬ãƒ¼

ä»¥ä¸‹ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ç™ºå‹•:
- ã€Œãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèªã€ã€Œãƒˆãƒ¬ãƒ¼ã‚¹ä¸€è¦§ã€ã€ŒAgent Traceã€
- ã€ŒAIè²¢çŒ®ç‡ã€ã€Œèª°ãŒæ›¸ã„ãŸã€ã€Œå¸°å±ç¢ºèªã€
- ã€Œã‚³ãƒ¼ãƒ‰å±¥æ­´ã€ã€Œç·¨é›†å±¥æ­´ã€
- `/agent-trace`

## æ©Ÿèƒ½æ¦‚è¦

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent Trace Management                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š çµ±è¨ˆè¡¨ç¤º     - AI/äººé–“ã®è²¢çŒ®ç‡ã€ãƒ¢ãƒ‡ãƒ«åˆ¥çµ±è¨ˆ            â”‚
â”‚  ğŸ“‹ ä¸€è¦§è¡¨ç¤º     - æœ€è¿‘ã®ãƒˆãƒ¬ãƒ¼ã‚¹ä¸€è¦§                       â”‚
â”‚  ğŸ” æ¤œç´¢        - ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥ã€æ—¥ä»˜åˆ¥ã®ãƒˆãƒ¬ãƒ¼ã‚¹æ¤œç´¢          â”‚
â”‚  ğŸ“„ ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ - ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ç”¨ãƒ¬ãƒãƒ¼ãƒˆ               â”‚
â”‚  ğŸ—„ï¸ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–   - å¤ã„ãƒˆãƒ¬ãƒ¼ã‚¹ã®æ•´ç†                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨æ–¹æ³•

### çµ±è¨ˆã‚’ç¢ºèª

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®çµ±è¨ˆã‚’è¡¨ç¤º
node -e "
const { TraceStore } = require('./.claude/lib/trace-store.ts');
const store = new TraceStore(process.cwd());
const stats = store.getStatistics();
console.log(JSON.stringify(stats, null, 2));
"
```

### æœ€è¿‘ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèª

```bash
# æœ€æ–°10ä»¶ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ç¤º
node -e "
const { TraceStore } = require('./.claude/lib/trace-store.ts');
const store = new TraceStore(process.cwd());
const traces = store.list(10);
traces.forEach(t => {
  console.log(\`[\${t.timestamp}] \${t.files.map(f => f.path).join(', ')}\`);
});
"
```

### ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’æ¤œç´¢

```bash
# src/api/auth.ts ã®ãƒˆãƒ¬ãƒ¼ã‚¹å±¥æ­´ã‚’è¡¨ç¤º
node -e "
const { TraceStore } = require('./.claude/lib/trace-store.ts');
const store = new TraceStore(process.cwd());
const traces = store.findByFile('src/api/auth.ts');
console.log(JSON.stringify(traces, null, 2));
"
```

## è‡ªå‹•è¨˜éŒ²ã®ä»•çµ„ã¿

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è‡ªå‹•ãƒˆãƒ¬ãƒ¼ã‚¹è¨˜éŒ²ãƒ•ãƒ­ãƒ¼                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Claude Code (Edit/Write)                                   â”‚
â”‚       â”‚                                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  PostToolUse Hook                                           â”‚
â”‚  (.claude/hooks/agent-trace-capture.js)                     â”‚
â”‚       â”‚                                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  Trace Record ç”Ÿæˆ                                          â”‚
â”‚  - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹                                             â”‚
â”‚  - è²¢çŒ®è€…ã‚¿ã‚¤ãƒ—ï¼ˆaiï¼‰                                       â”‚
â”‚  - ãƒ¢ãƒ‡ãƒ«æƒ…å ±                                               â”‚
â”‚  - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—                                           â”‚
â”‚  - Git commit/branch                                        â”‚
â”‚       â”‚                                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  .agent-trace/traces/*.json ã«ä¿å­˜                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ¬ã‚³ãƒ¼ãƒ‰æ§‹é€ 

```json
{
  "version": "0.1.0",
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": "2026-02-04T12:00:00Z",
  "files": [
    {
      "path": "src/utils/helper.ts",
      "conversations": [
        {
          "contributor_type": "ai",
          "model": "anthropic/claude-opus-4-5-20251101",
          "ranges": [{ "start_line": 1, "end_line": -1 }],
          "description": "Edit: text replacement"
        }
      ]
    }
  ],
  "vcs": {
    "type": "git",
    "commit": "abc123...",
    "branch": "main"
  },
  "tool": {
    "name": "taisun-agent",
    "version": "2.10.1"
  },
  "metadata": {
    "dev.taisun": {
      "hook": "agent-trace-capture",
      "tool_used": "Edit"
    }
  }
}
```

## è²¢çŒ®è€…ã‚¿ã‚¤ãƒ—

| ã‚¿ã‚¤ãƒ— | ã‚³ãƒ¼ãƒ‰ | èª¬æ˜ |
|--------|--------|------|
| äººé–“ | `human` | äººé–“ãŒç›´æ¥è¨˜è¿°ã—ãŸã‚³ãƒ¼ãƒ‰ |
| AI | `ai` | AIãŒç”Ÿæˆã—ãŸã‚³ãƒ¼ãƒ‰ |
| æ··åˆ | `mixed` | äººé–“ãŒç·¨é›†ã—ãŸAIã‚³ãƒ¼ãƒ‰ |
| ä¸æ˜ | `unknown` | èµ·æºãŒä¸æ˜ãªã‚³ãƒ¼ãƒ‰ |

## é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒˆãƒ¬ãƒ¼ã‚¹å¯¾è±¡å¤–ï¼ˆæ©Ÿå¯†ä¿è­·ï¼‰:

- `node_modules/`
- `.git/`
- `.agent-trace/`
- `.env*`
- `secrets/`, `credentials/`
- `*.pem`, `*.key`

## ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### /agent-trace stats
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®çµ±è¨ˆã‚’è¡¨ç¤º

### /agent-trace list [count]
æœ€è¿‘ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ä¸€è¦§è¡¨ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10ä»¶ï¼‰

### /agent-trace find <file-path>
ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒˆãƒ¬ãƒ¼ã‚¹å±¥æ­´ã‚’æ¤œç´¢

### /agent-trace report
ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ç”¨ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ

### /agent-trace archive [days]
æŒ‡å®šæ—¥æ•°ã‚ˆã‚Šå¤ã„ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30æ—¥ï¼‰

## ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ§‹é€ 

```
.agent-trace/
â”œâ”€â”€ traces/           # ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒˆãƒ¬ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ 2026-02-04_abc123.json
â”‚   â”œâ”€â”€ 2026-02-04_def456.json
â”‚   â””â”€â”€ ...
â””â”€â”€ archive/          # ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿ãƒˆãƒ¬ãƒ¼ã‚¹
    â””â”€â”€ 2026-01-*.json
```

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Agent Trace å…¬å¼ä»•æ§˜](https://agent-trace.dev/)
- [Cognition Blog](https://cognition.ai/blog/agent-trace)
- [çµ±åˆææ¡ˆæ›¸](../../../docs/AGENT_TRACE_INTEGRATION_PROPOSAL.md)

## æŠ€è¡“ä»•æ§˜

- **ä»•æ§˜ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.1.0
- **ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: `.claude/lib/trace-store.ts`
- **ãƒ•ãƒƒã‚¯**: `.claude/hooks/agent-trace-capture.js`
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: ãƒ­ãƒ¼ã‚«ãƒ«JSONï¼ˆ`.agent-trace/`ï¼‰

## å°†æ¥ã®æ‹¡å¼µäºˆå®š

- Phase 2: OpenTelemetryçµ±åˆ
- Phase 3: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰UI
- Phase 3: Context Graphæ§‹ç¯‰
